<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 9 Climate Data Interpreter</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script> 

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .container {
            width: 90%;
            max-width: 800px;
            background: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #007bff;
            text-align: center;
            margin-bottom: 20px;
        }
        h2 {
            color: #28a745;
            border-bottom: 2px solid #28a745;
            padding-bottom: 5px;
            margin-top: 25px;
        }
        .question-box {
            background-color: #eaf6ff;
            border: 1px solid #b8daff;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .feedback-box {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            display: none;
            line-height: 1.4;
        }
        .correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        .score {
            text-align: right;
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }
        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üåç Climate Data Interpreter üìä</h1>
    <p>Practice reading climate graphs and applying classification rules!</p>
    <div class="score">Score: <span id="scoreValue">0</span></div>

    <div class="game-area">

        <h2>Graph Interpretation Challenge</h2>
        <p>Answer the questions based on the climate graph generated below:</p>
        
        <div style="height: 350px; width: 100%; margin-bottom: 20px;">
            <canvas id="climateChart"></canvas>
        </div>

        <div id="graph-question" class="question-box">
            <p id="graph-q-text">Loading question...</p>
            <input type="text" id="graph-answer-input" placeholder="Enter month/value (e.g., J or 10)">
            <button onclick="checkGraphAnswer()">Submit</button>
            <div id="graph-feedback" class="feedback-box"></div>
        </div>

        <h2>Classification Challenge (Maritime vs. Continental)</h2>
        <div id="class-question" class="question-box">
            <p id="class-q-text">Loading data...</p>
            <p>Classify this climate type:</p>
            <button onclick="checkClassAnswer('Maritime')">Maritime</button>
            <button onclick="checkClassAnswer('Continental')">Continental</button>
            <div id="class-feedback" class="feedback-box"></div>
        </div>

    </div>
    </div>

<script>
    let score = 0;
    const scoreElement = document.getElementById('scoreValue');

    const graphQuestions = [
        // Questions based on the dynamically generated data
        {
            q: "What month is the **Maximum Temperature** (highest point on the line)? (Enter the first letter of the month)",
            a: "A", // August has 9¬∞C
            concept: "The highest point on the temperature line (the curve) represents the warmest month, which is **August** (9¬∞C)."
        },
        {
            q: "What is the approximate **Maximum Rainfall** value (highest bar)? (Enter the value in mm)",
            a: "40", // August has 40mm
            concept: "The maximum rainfall is the height of the tallest blue bar, which aligns with **40 mm** on the right y-axis (Rainfall)."
        },
        {
            q: "What is the approximate **Minimum Temperature** (lowest point on the line)? (Enter the value in ¬∞C, e.g., -20)",
            a: "-22", // February has -22¬∞C
            concept: "The lowest point on the temperature line (the curve) represents the coldest monthly average, which is approximately **-22¬∞C** (February)."
        },
        {
            q: "The line graph measures temperature in what unit? (Enter the unit symbol)",
            a: "¬∞C",
            concept: "The right y-axis (Temperature) is measured in **Degrees Celsius (¬∞C)**."
        }
    ];

    const classQuestions = [
        {
            range: 12, 
            precip: 1400, 
            a: "Maritime",
            [cite_start]concept: "This is **Maritime** because the Annual Temperature Range (12¬∞C) is **moderate** (less than 25¬∞C) AND the Total Annual Precipitation (1400 mm) is **wet** (greater than 1000 mm). Maritime climates are near a large body of water. [cite: 61, 62, 63, 64, 65, 66]"
        },
        {
            range: 35, 
            precip: 450, 
            a: "Continental",
            concept: "This is **Continental** because the Annual Temperature Range (35¬∞C) is **Extreme** (greater than 25¬∞C) AND the Total Annual Precipitation (450 mm) is **dry** (less than 1000 mm). [cite_start]Continental climates are far from a large body of water. [cite: 68, 70, 71, 72]"
        },
        {
            range: 28, 
            precip: 850, 
            a: "Continental",
            [cite_start]concept: "The **Extreme** Annual Temperature Range (28¬∞C is > 25¬∞C) is the key indicator for a **Continental** climate, which is also typically dry (850 mm < 1000 mm). [cite: 68, 70]"
        },
        {
            range: 19, 
            precip: 1100, 
            a: "Maritime",
            [cite_start]concept: "The **Moderate** Annual Temperature Range (19¬∞C is < 25¬∞C) and **Wet** Annual Precipitation (1100 mm is > 1000 mm) classify this as a **Maritime** climate. [cite: 61, 62, 63, 64, 65, 66]"
        }
    ];

    let currentGraphQIndex = 0;
    let currentClassQIndex = 0;

    // Data for dynamic chart generation
    const CHART_MONTHS = ['J', 'F', 'M', 'A', 'M', 'J', 'J', 'A', 'S', 'O', 'N', 'D'];
    const TEMP_DATA = [-20, -22, -16, -10, -5, 2, 8, 9, 7, 0, -10, -18]; 
    const PRECIP_DATA = [10, 8, 12, 16, 20, 25, 30, 40, 35, 28, 18, 12];


    // 3. JAVASCRIPT FUNCTION TO BUILD THE CHART
    function generateClimateChart() {
        const ctx = document.getElementById('climateChart').getContext('2d');
        
        Chart.register(ChartDataLabels); // Register plugin

        const climateChart = new Chart(ctx, {
            type: 'bar', 
            data: {
                labels: CHART_MONTHS,
                datasets: [
                    {
                        type: 'bar',
                        label: 'Rainfall (mm)',
                        data: PRECIP_DATA,
                        backgroundColor: 'rgba(54, 162, 235, 0.6)', 
                        yAxisID: 'yRain',
                    },
                    {
                        type: 'line',
                        label: 'Temperature (¬∞C)',
                        data: TEMP_DATA,
                        borderColor: 'rgb(255, 99, 132)', 
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        fill: false,
                        yAxisID: 'yTemp',
                        tension: 0.2, // Smoothes the line
                        pointRadius: 5
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Dynamic Climate Graph (Temperature Line & Rainfall Bars)'
                    },
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Month'
                        }
                    },
                    yRain: {
                        type: 'linear',
                        position: 'left',
                        title: {
                            display: true,
                            text: 'Rainfall (mm)'
                        },
                        min: 0,
                        max: 70
                    },
                    yTemp: {
                        type: 'linear',
                        position: 'right',
                        title: {
                            display: true,
                            text: 'Temperature (¬∞C)'
                        },
                        min: -25, // Corrected scale minimum
                        max: 10,  // Corrected scale maximum
                        grid: {
                            drawOnChartArea: false, 
                        }
                    }
                }
            }
        });
    }


    function loadGraphQuestion() {
        if (currentGraphQIndex >= graphQuestions.length) {
            document.getElementById('graph-q-text').textContent = "Graph Challenge Complete! Well done.";
            document.getElementById('graph-answer-input').style.display = 'none';
            document.querySelector('#graph-question button').style.display = 'none';
            return;
        }
        const qData = graphQuestions[currentGraphQIndex];
        document.getElementById('graph-q-text').innerHTML = `**Question ${currentGraphQIndex + 1}:** ${qData.q}`;
        document.getElementById('graph-answer-input').value = '';
        document.getElementById('graph-feedback').style.display = 'none';
    }

    function checkGraphAnswer() {
        const input = document.getElementById('graph-answer-input').value.trim();
        const feedbackBox = document.getElementById('graph-feedback');
        const qData = graphQuestions[currentGraphQIndex];

        if (!input) {
            feedbackBox.textContent = "Please enter an answer.";
            feedbackBox.className = 'feedback-box incorrect';
            feedbackBox.style.display = 'block';
            return;
        }

        if (input.toUpperCase() === qData.a.toUpperCase()) {
            feedbackBox.innerHTML = `‚úÖ **Correct!** ${qData.concept}`;
            feedbackBox.className = 'feedback-box correct';
            score += 1;
            scoreElement.textContent = score;
            currentGraphQIndex++;
            setTimeout(loadGraphQuestion, 3000); 
        } else {
            feedbackBox.innerHTML = `‚ùå **Incorrect.** The correct answer is **${qData.a}**. <br><br> **Concept Rule:** ${qData.concept}`;
            feedbackBox.className = 'feedback-box incorrect';
        }
        feedbackBox.style.display = 'block';
    }

    function loadClassQuestion() {
        if (currentClassQIndex >= classQuestions.length) {
            document.getElementById('class-q-text').textContent = "Classification Challenge Complete! Excellent work.";
            document.querySelector('#class-question button:nth-of-type(1)').style.display = 'none';
            document.querySelector('#class-question button:nth-of-type(2)').style.display = 'none';
            return;
        }
        const qData = classQuestions[currentClassQIndex];
        document.getElementById('class-q-text').innerHTML = `**Data for Location ${currentClassQIndex + 1}:** <br> Annual Temperature Range: **${qData.range}¬∞C** <br> Total Annual Precipitation: **${qData.precip} mm**`;
        document.getElementById('class-feedback').style.display = 'none';
    }

    function checkClassAnswer(userAnswer) {
        const feedbackBox = document.getElementById('class-feedback');
        const qData = classQuestions[currentClassQIndex];

        if (userAnswer === qData.a) {
            feedbackBox.innerHTML = `‚úÖ **Correct!** <br><br> **Classification Rule:** ${qData.concept}`;
            feedbackBox.className = 'feedback-box correct';
            score += 2; 
            scoreElement.textContent = score;
            currentClassQIndex++;
            setTimeout(loadClassQuestion, 4000); 
        } else {
            feedbackBox.innerHTML = `‚ùå **Incorrect.** You chose ${userAnswer}. <br><br> **Classification Rule:** ${qData.concept}`;
            feedbackBox.className = 'feedback-box incorrect';
        }
        feedbackBox.style.display = 'block';
    }

    // Initial loads
    window.onload = () => {
        // Draw the chart when the page loads
        generateClimateChart(); 
        
        // Randomize questions for replayability
        graphQuestions.sort(() => Math.random() - 0.5);
        classQuestions.sort(() => Math.random() - 0.5);
        
        loadGraphQuestion();
        loadClassQuestion();
    };
</script>

</body>
</html>
